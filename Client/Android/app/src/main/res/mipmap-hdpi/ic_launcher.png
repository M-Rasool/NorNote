package ir.norooch.nornote;

import android.content.Context;
import android.content.Intent;
import android.widget.EditText;
import android.widget.Toast;

import com.android.volley.Request;
import com.android.volley.RequestQueue;
import com.android.volley.Response;
import com.android.volley.VolleyError;
import com.android.volley.toolbox.JsonArrayRequest;
import com.android.volley.toolbox.JsonObjectRequest;
import com.android.volley.toolbox.Volley;

import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import java.util.ArrayList;

public class Handler {

    public void login(final Context context, EditText username, EditText password) {
        final String user = username.getText().toString().trim();
        String pass = password.getText().toString().trim();

        if (user.equals("")) {
            username.requestFocus();
        } else if (pass.equals("")) {
            password.requestFocus();
        } else {
//            Toast.makeText(context, "Login", Toast.LENGTH_SHORT).show();
//            Intent intent = new Intent(context, Dashboard.class);
//            intent.putExtra("username", user);
//            context.startActivity(intent);
            RequestQueue requestQueue = Volley.newRequestQueue(context);
            String url = "http://5.233.136.79/NorNote/Start.php";
            JSONObject loginObject = new JSONObject();
            try {
                loginObject.put("username", user);
                loginObject.put("password", pass);
            } catch (JSONException e) {
                e.printStackTrace();
            }
            JsonObjectRequest request = new JsonObjectRequest(Request.Method.POST, url, loginObject, new Response.Listener<JSONObject>() {
                @Override
                public void onResponse(JSONObject response) {
                    Toast.makeText(context, response.toString(), Toast.LENGTH_SHORT).show();
//                    try {
//                        if (response.getBoolean("isOk")) {
//                            Intent intent = new Intent(context, Dashboard.class);
//                            intent.putExtra("username", user);
//                            context.startActivity(intent);
//                        }
//                    } catch (JSONException e) {
//                        e.printStackTrace();
//                    }
                }
            }, new Response.ErrorListener() {
                @Override
                public void onErrorResponse(VolleyError error) {
                    error.printStackTrace();
                }
            });

            requestQueue.add(request);
        }
    }


    public void signUp(final Context context, EditText username, EditText password, EditText confirmPass) {
        String user = username.getText().toString().trim();
        String pass = password.getText().toString().trim